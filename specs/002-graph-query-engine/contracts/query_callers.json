{
  "name": "query_callers",
  "description": "Find all functions/methods that call a specified function. Supports multi-level caller chains up to max_depth. Use this to understand function usage and assess impact before refactoring.",
  "inputSchema": {
    "type": "object",
    "properties": {
      "function_name": {
        "type": "string",
        "description": "Fully qualified name of the function to find callers for (e.g., 'auth.services.UserService.login' or 'utils.validators.check_email')"
      },
      "max_depth": {
        "type": "integer",
        "description": "Maximum depth for caller chains. 1 = direct callers only, 2 = callers of callers, etc. (default: 1)",
        "default": 1,
        "minimum": 1,
        "maximum": 5
      },
      "include_paths": {
        "type": "boolean",
        "description": "Whether to include file paths and line numbers in results (default: true)",
        "default": true
      }
    },
    "required": ["function_name"]
  },
  "outputSchema": {
    "type": "object",
    "properties": {
      "query": {"type": "string"},
      "results": {
        "type": "array",
        "items": {
          "type": "object",
          "properties": {
            "caller": {"type": "string", "description": "Qualified name of calling function"},
            "file_path": {"type": "string", "description": "Path to source file (if include_paths=true)"},
            "line_number": {"type": "integer", "description": "Line number of call site (if include_paths=true)"},
            "depth": {"type": "integer", "description": "Distance from target (1=direct caller)"}
          }
        }
      },
      "metadata": {
        "type": "object",
        "properties": {
          "row_count": {"type": "integer"},
          "total_count": {"type": "integer"},
          "truncated": {"type": "boolean"},
          "execution_time_ms": {"type": "number"},
          "max_depth": {"type": "integer"}
        }
      }
    }
  }
}
